package services;

import java.util.Date;

import javax.transaction.Transactional;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.util.Assert;

import repositories.CommentRepository;
import domain.Comment;
import domain.Film;
import domain.FilmEnthusiast;
import domain.Forum;

@Service
@Transactional
public class CommentService {
	
	//Repository
	
	@Autowired
	private CommentRepository commentRepository;
	
	//Services
	@Autowired
	private ActorService actorService;
	
	public Comment create(){
		Comment result = new Comment();
		
		FilmEnthusiast principal = (FilmEnthusiast) this.actorService.findByPrincipal();
		
		Assert.isTrue(this.actorService.checkAuthority(principal,"FILMENTHUSIAST"));
		
		result.setFilmEnthusiast(principal);
		result.setPublishedMoment(new Date(System.currentTimeMillis()-1));
		
		
	}
	
	public Comment save(final Comment comment,Film film, Forum forum){
		
		FilmEnthusiast principal = (FilmEnthusiast) this.actorService.findByPrincipal();
		
		Assert.isTrue(principal.getId() == comment.getFilmEnthusiast().getId());
		
		comment.setPublishedMoment(new Date(System.currentTimeMillis()-1));
		
	}
}

