package repositories;

import java.util.Collection;

import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.stereotype.Repository;
import org.springframework.data.jpa.repository.Query;
import domain.Film;

@Repository
public interface FilmRepository extends JpaRepository<Film, Integer>{
	
	@Query("select max(1.0*(select count(*) from Comment c where c.film=f)),min(1.0*(select count(*) from Comment c where c.film=f)),avg(1.0*(select count(*) from Comment c where c.film=f)),stddev(1.0*(select count(*) from Comment c where c.film=f)) from Film f")
	Double [] statsCommentsPerFilm();
	
	@Query("select max(f.persons.size),min(f.persons.size),avg(f.persons.size),stddev(f.persons.size) from Film f")
	Double[] statsPersonsPerFilm();
	
	@Query("select f from Film f where f.avgReviewsRating= (select max(f.avgReviewsRating)from Film f)")
	Collection<Film> filmsWithHighestRating();
}
